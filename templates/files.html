{% extends '_base.html' %}

{% block content %}


<div class="container">
	<h4>Files Associated Directly With Your User:
	<button data-toggle="collapse" data-target="#directfiles" class="btn">></button>
	</h4>
	<br>
	<div id="directfiles" class="collapse">
	{% set files = files %}
	{% include "partials/files.html" with context %}
	</div>
</div>

<br>
<br>

<div class="container">
	<div class="row">
		<div class="col-md-6">
			<div class="input-group">
				<div class="input-group-btn">
				<!-- Button -->
					<div class="dropdown">
						<button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown">Datasets<span class="caret"></span></button>
							<ul class="dropdown-menu">
								{% for dataset in current_user.datasets %}
									{% if dataset.files.all() != [] %}
										<li data-toggle="collapse" data-target=#{{dataset.id}}><a href="#">{{dataset.id}} {{dataset.name}}</a></li>
									{% endif %}
								{% endfor %}
							</ul>
					</div>
				<!-- Button End -->
				</div>
				<!-- Input Bar -->
				<div id="datasetsearch">
					<input class="typeahead form-control" type="text" placeholder="Search for dataset (not working at the moment)">
				</div>
				<script type="text/javascript">
						var datasets = ['SRR1525443', 'SRR1525444'];

						var sdatasets = new Bloodhound({
							datumTokenizer: Bloodhound.tokenizers.obj.whitespace,
  							queryTokenizer: Bloodhound.tokenizers.whitespace,
	  						local: datasets
	  					});
  						

						$('#datasetsearch.typeahead').typeahead({
							highlight: true,
							minLength: 1,
						},
						{
							name: 'datasets',
							limit: 10,
							local: sdatasets,
						});
				</script>
			</div>
		</div>
	</div>

	{% for dataset in current_user.datasets %}
		{% if dataset.files.all() != [] %}
			<br>
			<div id={{dataset.id}} class="collapse">
				<h4>Files Associated With Your Dataset {{dataset.id}} {{dataset.name}}</h4>
					{% set files = dataset.files %}
					{% include "partials/files.html" with context %}
					{% endif %}
			</div>
	{% endfor %}
</div>






<div class="container">
<br>
{% if dropbox_files %}
	<h2>Or click to add any of these from your dropbox:</h2>
	<table class="table table-striped">
		<thead>
			<tr>
				<th></th>
			</tr>
		</thead>
		<tbody>
			{% for file in dropbox_files %}
				<tr>
					<form role='form' method='POST' action='/files'>
					<th><input type='submit' name='submit' value={{file}}></th>
					</form>
				</tr>
			{% endfor %}
		</tbody>
	</table>
{% endif %}
</div>
{%endblock content %}


